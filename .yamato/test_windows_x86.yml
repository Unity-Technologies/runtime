{% metadata_file .yamato/Globals.metafile %}
---
name: Test Windows x86

agent:
  type: Unity::VM
  image: platform-foundation/windows-vs2019-il2cpp-bokken:v1.1.7-1038262
  flavor: b1.xlarge

dependencies:
  - path: .yamato/build_windows_x86.yml

commands:
# build/run tests
  - dotnet build unity\managed.sln -c Release
#  - |
#    cd unity\embed_api_tests
#    cmake . -A Win32
#    cmake --build . --config Release
#    Release\mono_test_app.exe
  - build.cmd libs.tests -test /p:RunSmokeTestsOnly=true -a x86 -c release -ci
  - src\tests\build.cmd x86 release ci tree GC tree JIT tree baseservices tree interop tree reflection
  - src\tests\run.cmd x86 release

triggers:
  pull_requests:
    - targets:
        only:
          - "unity-main"
